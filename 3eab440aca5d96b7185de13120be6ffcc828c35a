{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "fe7233fb_9ce85d98",
        "filename": "subprojects/dhcp-done/update-dhcp-status.cpp",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1001693
      },
      "writtenOn": "2025-03-07T22:05:53Z",
      "side": 1,
      "message": "Looks like the whole purpose of this separate usage is to log this formatted message into the syslog? If that is the case then I suggest:\n1. in the gbmc-br-dhcp script have a function, take \"State\" \"Time\" \"Message\" \"Code\" \"Retries\" as input, output is a string e.g. \"formatted_log_msg\"\n2. Just call \"update-dhcp-status \u0027ONGOING\u0027 formatted_log_msg\", and output it into syslog just with echo.\n\nThis way we don\u0027t have to change this file at all, avoiding having two weird usage, and also we can avoid a different syslog entry name \"gbmc_netboot\" other than \"udhcpc6\", easy for us to corelated with the original log/error message in the process.\n\nLet me know if this simplify things a bit.",
      "range": {
        "startLine": 84,
        "startChar": 8,
        "endLine": 87,
        "endChar": 31
      },
      "revId": "3eab440aca5d96b7185de13120be6ffcc828c35a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f6b77931_97993b50",
        "filename": "subprojects/dhcp-done/update-dhcp-status.cpp",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1002184
      },
      "writtenOn": "2025-03-07T22:45:14Z",
      "side": 1,
      "message": "We could do that, reason I wanted to do that is because I intentionally wanted structured messages to appear as `gbmc_netboot` so we can easily filter it for later on analysis on cloud, if it doesn\u0027t have a tag and just tied with \"udhcpc6\" we\u0027ll have to figure out some sort of filtering and will slow down database analysis on scale. What do you think?\n\nMy only concern about adding filtering mechanism on backend instead of here where clear tag enables us to extract messages is scalability.",
      "parentUuid": "fe7233fb_9ce85d98",
      "range": {
        "startLine": 84,
        "startChar": 8,
        "endLine": 87,
        "endChar": 31
      },
      "revId": "3eab440aca5d96b7185de13120be6ffcc828c35a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0f1cddfb_986a4471",
        "filename": "subprojects/dhcp-done/update-dhcp-status.cpp",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1001693
      },
      "writtenOn": "2025-03-07T23:14:43Z",
      "side": 1,
      "message": "If you are talking about the identifier of the journal, and want to keep some logs in udhcpc6 as it is, and the formatted log as a different identifier like \"gbmc-netboot\", you can just do ```systemd-cat -t gbmc-netboot echo $formatted_log_msg ```",
      "parentUuid": "f6b77931_97993b50",
      "range": {
        "startLine": 84,
        "startChar": 8,
        "endLine": 87,
        "endChar": 31
      },
      "revId": "3eab440aca5d96b7185de13120be6ffcc828c35a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "402f26c3_210ea3ea",
        "filename": "subprojects/dhcp-done/update-dhcp-status.cpp",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1002184
      },
      "writtenOn": "2025-03-11T15:56:07Z",
      "side": 1,
      "message": "I thought more about it, we could do it that way. However, the main reason of writing the message in this code file is not just syslog (I misread the first comment). \n\nThe main usage of this function comes in two folds:\n- writing structured message to rsyslog\n- writing structured message to statusFile\n\nI had originally made a new file (update-install-status) but per your recommendation was to combine the two since inherently it\u0027s the same function and it makes sense that way. \n\nI can also have both operations done in bash if you\u0027d prefer that and we can deprecate this completely once we move to the new workflow, I just thought this is nicely done and adding the extension to it of supporting syslog and structured data along with its function. Let me know what you\u0027d rather and I can adjust the code. :)",
      "parentUuid": "0f1cddfb_986a4471",
      "range": {
        "startLine": 84,
        "startChar": 8,
        "endLine": 87,
        "endChar": 31
      },
      "revId": "3eab440aca5d96b7185de13120be6ffcc828c35a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6fdef1c2_4e0f6085",
        "filename": "subprojects/dhcp-done/update-dhcp-status.cpp",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1001693
      },
      "writtenOn": "2025-03-11T18:09:59Z",
      "side": 1,
      "message": "Right functional-wise this looks good. I am just suggesting keeping this util simple and not having multiple usage.\n\nBy doing that you can either keep the original usage, update_dhcp_status \u003cstate\u003e \u003cmessage\u003e, and format the message in bash, or you can completely remove the original usage, and change every logging point in the firmware to your new usage: \"update_dhcp_status \u003cState\u003e \u003cTime\u003e \u003cMessage\u003e \u003cCode\u003e \u003cRetries\u003e\", I am fine with either way.",
      "parentUuid": "402f26c3_210ea3ea",
      "range": {
        "startLine": 84,
        "startChar": 8,
        "endLine": 87,
        "endChar": 31
      },
      "revId": "3eab440aca5d96b7185de13120be6ffcc828c35a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "06c7e2a5_b77e46cb",
        "filename": "subprojects/dhcp-done/update-dhcp-status.cpp",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1002184
      },
      "writtenOn": "2025-03-13T11:50:09Z",
      "side": 1,
      "message": "I tried creating a binary update_dhcp_status, it was kind of odd to see update_dhcp_status in the script sometimes and then (v1) calling update-dhcp-status, I\u0027d rather have it all in one place. There\u0027s also some potential racing condition when multiple scripts calling this going out of order. I did some stress tests and it went our of order (unless I make it hold for bash script execution based on return value). \n\nIf you\u0027re truly fine either way, let\u0027s keep it this way as it has been stress-tested and has been reliable across weeks of testing.",
      "parentUuid": "6fdef1c2_4e0f6085",
      "range": {
        "startLine": 84,
        "startChar": 8,
        "endLine": 87,
        "endChar": 31
      },
      "revId": "3eab440aca5d96b7185de13120be6ffcc828c35a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85a85040_12285fca",
        "filename": "subprojects/dhcp-done/update-dhcp-status.cpp",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1001693
      },
      "writtenOn": "2025-03-14T17:12:08Z",
      "side": 1,
      "message": "oh I never meant to create 2 binaries (sry if there is ambigious about \"_\" and \"-\"). I just mean change the usage to \"update-dhcp-status \u003cstatus code\u003e \u003cState\u003e \u003cTime\u003e \u003cMessage\u003e \u003cCode\u003e \u003cRetries\u003e\", and change all existing log point to this as well.",
      "parentUuid": "06c7e2a5_b77e46cb",
      "range": {
        "startLine": 84,
        "startChar": 8,
        "endLine": 87,
        "endChar": 31
      },
      "revId": "3eab440aca5d96b7185de13120be6ffcc828c35a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ],
  "submitRequirementResults": []
}